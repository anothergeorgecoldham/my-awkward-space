---
import Layout from "../layouts/Layout.astro";
import { siteConfig, homeContent } from "../config/content";
import { getAllPosts } from "../utils/getPosts";

const posts = getAllPosts();
const latestPost = posts.length > 0 ? posts[0] : null;
---

<Layout title={siteConfig.title} description={siteConfig.description}>
  <section class="min-h-[50vh] lg:min-h-[60vh] flex items-center py-6 lg:py-10">
    <div class="flex flex-col lg:flex-row items-center justify-between w-full gap-8 lg:gap-12">
      <!-- Left: copy -->
      <div class="w-full lg:w-[45%] text-left">
        <h1 class="text-3xl font-bold tracking-tight text-neutral-900 dark:text-neutral-100 sm:text-4xl">
          {homeContent.title}
        </h1>

        <p class="mt-3 text-lg leading-7 text-neutral-600 dark:text-neutral-400">
          {homeContent.description}
        </p>

        <div class="flex flex-row gap-4 mt-6">
          <a
            class="group inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-300 hover:scale-105 shadow-accent bg-accent-primary text-white hover:bg-accent-primarySoft"
            href={homeContent.buttons.about.href}
          >
            {homeContent.buttons.about.text}
            <svg
              class="w-4 h-4 transition-transform duration-200 group-hover:translate-x-1"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2.5"
                d="M13 7l5 5m0 0l-5 5m5-5H6"
              ></path>
            </svg>
          </a>

          <a
            class="group inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border border-neutral-300 dark:border-neutral-700/70 bg-neutral-100 dark:bg-white/5 text-neutral-700 dark:text-neutral-200 hover:bg-accent-primary/10 hover:border-accent-primary/40 hover:text-accent-secondary transition-all duration-300 hover:scale-105"
            href={homeContent.buttons.posts.href}
          >
            {homeContent.buttons.posts.text}
            <svg
              class="w-4 h-4 transition-transform duration-200 group-hover:translate-x-1"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2.5"
                d="M13 7l5 5m0 0l-5 5m5-5H6"
              ></path>
            </svg>
          </a>
        </div>
      </div>

      <!-- Right: hero image -->
      <div class="relative w-full lg:w-[45%] flex items-center justify-center bg-transparent overflow-hidden z-20">
        <div
          class="relative overflow-hidden"
          style="width: min(500px, 80vw); height: min(400px, 50vh); max-width: 100%; max-height: 50vh;"
        >
          <img
            src={homeContent.images.light}
            alt="Tech Background"
            class="w-full h-full object-contain animate-[float_15s_ease-in-out_infinite] hover:scale-125 transition-transform duration-300 opacity-90 dark:hidden"
          />

          <img
            src={homeContent.images.dark}
            alt="Tech Background Dark"
            class="w-full h-full object-contain animate-[float_15s_ease-in-out_infinite] hover:scale-125 transition-transform duration-300 opacity-90 hidden dark:block"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- Upcoming Talk & Latest Post Grid -->
  {(homeContent.upcomingTalk || latestPost) && (
    <section class="py-6 lg:py-10 border-t border-neutral-200 dark:border-neutral-800">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Upcoming Talk -->
        {homeContent.upcomingTalk && (
          <div class="flex flex-col">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-xl font-bold tracking-tight text-neutral-900 dark:text-neutral-100">
                Upcoming Talk
              </h2>
            </div>

            <a href={homeContent.upcomingTalk.url} target="_blank" rel="noopener noreferrer" class="group block flex-1">
              <article
                class="h-full rounded-2xl border border-neutral-300 dark:border-neutral-800/70 bg-neutral-100 dark:bg-white/5 p-6
                       transition-all duration-300
                       hover:border-accent-primary/40 hover:bg-accent-primary/5 hover:shadow-accentGlow"
              >
                <div class="flex items-start justify-between gap-4">
                  <div class="min-w-0">
                    <h3 class="text-lg font-bold text-neutral-900 dark:text-neutral-100 transition-colors group-hover:text-accent-secondary">
                      {homeContent.upcomingTalk.title}
                    </h3>

                    <p class="mt-2 text-sm font-medium text-accent-primary">
                      {homeContent.upcomingTalk.conference}
                    </p>

                    <div class="mt-3 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-neutral-500 dark:text-neutral-500">
                      <span>{homeContent.upcomingTalk.date}</span>
                      {homeContent.upcomingTalk.location && <span>• {homeContent.upcomingTalk.location}</span>}
                    </div>
                  </div>

                  <span class="mt-1 text-neutral-500 transition-colors group-hover:text-accent-secondary">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                    </svg>
                  </span>
                </div>
              </article>
            </a>
          </div>
        )}

        <!-- Latest Blog Post -->
        {latestPost && (
          <div class="flex flex-col">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-xl font-bold tracking-tight text-neutral-900 dark:text-neutral-100">
                Latest Post
              </h2>
              <a
                href="/blog/"
                class="text-sm font-medium text-accent-primary hover:text-accent-secondary transition-colors"
              >
                View all →
              </a>
            </div>

            <a href={latestPost.href} class="group block flex-1">
              <article
                class="h-full rounded-2xl border border-neutral-300 dark:border-neutral-800/70 bg-neutral-100 dark:bg-white/5 p-6
                       transition-all duration-300
                       hover:border-accent-primary/40 hover:bg-accent-primary/5 hover:shadow-accentGlow"
              >
                <div class="flex items-start justify-between gap-4">
                  <div class="min-w-0">
                    <h3 class="text-lg font-bold text-neutral-900 dark:text-neutral-100 transition-colors group-hover:text-accent-secondary">
                      {latestPost.title}
                    </h3>

                    {latestPost.description && (
                      <p class="mt-2 text-sm text-neutral-600 dark:text-neutral-400">
                        {latestPost.description}
                      </p>
                    )}

                    <div class="mt-3 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-neutral-500 dark:text-neutral-500">
                      {latestPost.date && <span>{latestPost.date}</span>}
                      {latestPost.readTime && <span>• {latestPost.readTime}</span>}
                    </div>
                  </div>

                  <span class="mt-1 text-neutral-500 transition-colors group-hover:text-accent-secondary">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                    </svg>
                  </span>
                </div>
              </article>
            </a>
          </div>
        )}
      </div>
    </section>
  )}
</Layout>
